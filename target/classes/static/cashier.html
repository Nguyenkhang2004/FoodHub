<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>üåà Rainbow Cashier Dashboard</title>
  <style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #0f0f23, #1a1a2e, #16213e);
        margin: 0;
        padding: 20px;
        color: #ffffff;
        min-height: 100vh;
        position: relative;
        overflow-x: hidden;
    }

    /* Rainbow gradient background animation */
    body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(45deg,
            rgba(255, 0, 150, 0.1),
            rgba(255, 100, 0, 0.1),
            rgba(255, 255, 0, 0.1),
            rgba(0, 255, 100, 0.1),
            rgba(0, 150, 255, 0.1),
            rgba(100, 0, 255, 0.1),
            rgba(255, 0, 100, 0.1)
        );
        background-size: 400% 400%;
        animation: rainbowMove 15s ease infinite;
        z-index: -1;
        pointer-events: none;
    }

    @keyframes rainbowMove {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }

    h1 {
        text-align: center;
        margin-bottom: 30px;
        font-size: 3em;
        background: linear-gradient(45deg, #ff006e, #ff7900, #ffff00, #00ff64, #0096ff, #6400ff, #ff0064);
        background-size: 400%;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        animation: rainbowText 3s ease-in-out infinite;
        text-shadow: 0 0 30px rgba(255, 255, 255, 0.3);
    }

    @keyframes rainbowText {
        0%, 100% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
    }

    .nav-buttons {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-bottom: 40px;
        flex-wrap: wrap;
    }

    .nav-buttons button {
        padding: 15px 30px;
        background: rgba(255, 255, 255, 0.1);
        border: 2px solid transparent;
        color: #ffffff;
        border-radius: 25px;
        cursor: pointer;
        font-weight: bold;
        font-size: 1.1em;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
        position: relative;
        overflow: hidden;
    }

    .nav-buttons button::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: all 0.5s;
    }

    .nav-buttons button:hover::before {
        left: 100%;
    }

    .nav-buttons button:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(255, 255, 255, 0.2);
        border: 2px solid rgba(255, 255, 255, 0.3);
    }

    .nav-buttons button:nth-child(1) { border-color: #ff006e; }
    .nav-buttons button:nth-child(2) { border-color: #ff7900; }
    .nav-buttons button:nth-child(3) { border-color: #00ff64; }
    .nav-buttons button:nth-child(4) { border-color: #0096ff; }

    .nav-buttons button.active {
        background: linear-gradient(45deg, #ff006e, #ff7900, #ffff00, #00ff64, #0096ff, #6400ff, #ff0064);
        background-size: 400%;
        animation: rainbowBtn 3s ease-in-out infinite;
        color: #ffffff;
        transform: translateY(-3px);
        box-shadow: 0 15px 35px rgba(255, 0, 110, 0.4);
    }

    @keyframes rainbowBtn {
        0%, 100% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
    }

    .section {
        display: none;
        background: rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(15px);
        border-radius: 20px;
        padding: 30px;
        margin-bottom: 30px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, #ff006e, #ff7900, #ffff00, #00ff64, #0096ff, #6400ff, #ff0064);
        background-size: 400%;
        animation: rainbowBorder 3s ease-in-out infinite;
    }

    @keyframes rainbowBorder {
        0%, 100% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
    }

    .section.active {
        display: block;
        animation: slideIn 0.5s ease-out;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .section:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 45px rgba(255, 255, 255, 0.1);
    }

    .section h2 {
        margin-top: 0;
        margin-bottom: 25px;
        font-size: 2em;
        background: linear-gradient(45deg, #00ff64, #0096ff);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    label {
        display: block;
        margin: 15px 0;
        color: #ecf0f1;
        font-weight: 500;
        font-size: 1.1em;
    }

    input[type="number"],
    input[type="text"],
    input[type="datetime-local"],
    select {
        padding: 15px 20px;
        border: 2px solid rgba(255, 255, 255, 0.2);
        border-radius: 15px;
        width: 100%;
        max-width: 400px;
        background: rgba(255, 255, 255, 0.1);
        color: #ffffff;
        font-size: 1em;
        backdrop-filter: blur(5px);
        transition: all 0.3s ease;
        margin-top: 8px;
    }

    input:focus,
    select:focus {
        outline: none;
        border-color: #ff006e;
        box-shadow: 0 0 20px rgba(255, 0, 110, 0.3);
        transform: translateY(-2px);
    }

    button {
        margin-top: 20px;
        padding: 15px 30px;
        background: linear-gradient(45deg, #ff006e, #0096ff);
        border: none;
        color: #ffffff;
        border-radius: 15px;
        cursor: pointer;
        font-weight: bold;
        font-size: 1.1em;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(255, 0, 110, 0.3);
    }

    button:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(255, 0, 110, 0.4);
        background: linear-gradient(45deg, #ff0064, #00ff64);
    }

    .error {
        color: #ff4757;
        font-weight: bold;
        margin-bottom: 15px;
        padding: 15px;
        background: rgba(255, 71, 87, 0.1);
        border-radius: 10px;
        border-left: 4px solid #ff4757;
        backdrop-filter: blur(5px);
    }

    .success {
        color: #2ed573;
        font-weight: bold;
        margin-bottom: 15px;
        padding: 15px;
        background: rgba(46, 213, 115, 0.1);
        border-radius: 10px;
        border-left: 4px solid #2ed573;
        backdrop-filter: blur(5px);
    }

    table {
        border-collapse: collapse;
        width: 100%;
        margin-top: 20px;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 15px;
        overflow: hidden;
        backdrop-filter: blur(10px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    }

    th, td {
        border: 1px solid rgba(255, 255, 255, 0.1);
        padding: 15px;
        text-align: left;
        color: #ecf0f1;
    }

    th {
        background: linear-gradient(45deg, rgba(255, 0, 110, 0.3), rgba(0, 150, 255, 0.3));
        font-weight: bold;
        text-transform: uppercase;
        letter-spacing: 1px;
        border-bottom: 2px solid rgba(255, 255, 255, 0.2);
    }

    tr:nth-child(even) {
        background: rgba(255, 255, 255, 0.05);
    }

    tr:hover {
        background: rgba(255, 255, 255, 0.1);
        transform: scale(1.01);
        transition: all 0.3s ease;
    }

    #paymentResult,
    #revenueResult {
        margin-top: 25px;
        padding: 20px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 15px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
    }

    #paymentResult p,
    #revenueResult h3 {
        margin: 10px 0;
        color: #ffffff;
    }

    #paymentResult h3,
    #revenueResult h3 {
        color: #00ff64;
        font-size: 1.3em;
        margin-bottom: 15px;
    }

    /* Scrollbar styling */
    ::-webkit-scrollbar {
        width: 12px;
    }

    ::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb {
        background: linear-gradient(45deg, #ff006e, #0096ff);
        border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(45deg, #ff0064, #00ff64);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        body {
            padding: 10px;
        }

        h1 {
            font-size: 2.2em;
        }

        .nav-buttons {
            flex-direction: column;
            gap: 15px;
        }

        .nav-buttons button {
            width: 100%;
        }

        .section {
            padding: 20px;
        }

        input, select, button {
            max-width: 100%;
        }

        table {
            font-size: 0.9em;
        }

        th, td {
            padding: 10px 8px;
        }
    }

    @media (max-width: 480px) {
        h1 {
            font-size: 1.8em;
        }

        .section h2 {
            font-size: 1.5em;
        }

        table {
            font-size: 0.8em;
        }

        th, td {
            padding: 8px 5px;
        }
    }

    /* Loading Animation */
    .loading {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 3px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: #ff006e;
        animation: spin 1s ease-in-out infinite;
        margin-left: 10px;
    }

    @keyframes spin {
        to { transform: rotate(360deg); }
    }

    /* Floating particles effect */
    .particle {
        position: absolute;
        width: 4px;
        height: 4px;
        background: rgba(255, 255, 255, 0.6);
        border-radius: 50%;
        animation: float 6s ease-in-out infinite;
        pointer-events: none;
    }

    @keyframes float {
        0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 1; }
        50% { transform: translateY(-20px) rotate(180deg); opacity: 0.5; }
    }

    .revenue-stats {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-around;
    margin-top: 20px;
}




.stat-card {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 15px;
    padding: 20px;
    text-align: center;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    width: 200px;
    margin: 10px;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
}

.stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 35px rgba(255, 0, 110, 0.3);
}

.stat-card h4 {
    margin: 0;
    font-size: 1.1em;
    color: #ecf0f1;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.stat-card .value {
    font-size: 1.5em;
    font-weight: bold;
    margin: 10px 0;
    background: linear-gradient(45deg, #ff006e, #00ff64);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

@keyframes countUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.stat-card {
    animation: countUp 0.5s ease-in-out;
}




    /* CSS t·ª´ code m·∫´u */
.form-container {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 40px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    width: 100%;
    max-width: 480px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    margin: 0 auto;
}

.form-header {
    text-align: center;
    margin-bottom: 30px;
}

.form-header h1 {
    color: #ffffff;
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 10px;
}

.form-header p {
    color: #a0aec0;
    font-size: 1rem;
}

.form-group {
    margin-bottom: 25px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    color: #ffffff;
    font-weight: 600;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.input-wrapper {
    position: relative;
}

.form-input {
    width: 100%;
    padding: 15px 20px;
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    font-size: 1rem;
    transition: all 0.3s ease;
    background: rgba(255, 255, 255, 0.05);
    color: #ffffff;
    backdrop-filter: blur(5px);
}

.form-input:focus {
    outline: none;
    border-color: #ff006e;
    box-shadow: 0 0 0 3px rgba(255, 0, 110, 0.2);
    transform: translateY(-2px);
}

.form-input:hover {
    border-color: rgba(255, 255, 255, 0.3);
}

.icon {
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    color: #a0aec0;
    font-size: 1.2rem;
    pointer-events: none;
}

.time-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
}

.quick-select {
    margin-bottom: 20px;
}

.quick-select h3 {
    color: #ffffff;
    font-size: 0.9rem;
    margin-bottom: 10px;
    font-weight: 600;
}

.quick-buttons {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.quick-btn {
    padding: 8px 16px;
    border: 2px solid rgba(255, 255, 255, 0.2);
    background: rgba(255, 255, 255, 0.05);
    color: #ffffff;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 0.85rem;
    font-weight: 500;
}

.quick-btn:hover {
    border-color: #ff006e;
    background: #ff006e;
    color: white;
    transform: translateY(-2px);
}

.quick-btn.active {
    background: #ff006e;
    border-color: #ff006e;
    color: white;
}

.submit-btn {
    width: 100%;
    padding: 16px;
    background: linear-gradient(45deg, #ff006e, #0096ff);
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-top: 20px;
}

.submit-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 25px rgba(255, 0, 110, 0.3);
}

.submit-btn:active {
    transform: translateY(-1px);
}

.error-message {
    color: #ff4757;
    font-size: 0.85rem;
    margin-top: 5px;
    display: none;
    padding: 10px;
    background: rgba(255, 71, 87, 0.1);
    border-radius: 8px;
}

@media (max-width: 480px) {
    .form-container {
        padding: 25px;
        margin: 10px;
    }

    .form-header h1 {
        font-size: 1.5rem;
    }

    .time-grid {
        grid-template-columns: 1fr;
    }

    .quick-buttons {
        justify-content: center;
    }
}

.form-container {
    animation: slideUp 0.6s ease-out;
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}


  </style>
</head>
<body>
<h1>üåà Rainbow Cashier Dashboard</h1>

<!-- Navigation Buttons -->
<div class="nav-buttons">
  <button onclick="showSection('payment')" id="paymentBtn">üí≥ Process Payment</button>
  <button onclick="showSection('cancel')" id="cancelBtn">‚ùå Cancel/Refund</button>
  <button onclick="showSection('transactions')" id="transactionsBtn">üìä Transactions</button>
  <button onclick="showSection('revenue')" id="revenueBtn">üí∞ Revenue</button>
</div>

<!-- Messages -->
<div id="message" class="success"></div>
<div id="error" class="error"></div>

<!-- Payment -->
<div class="section" id="paymentSection">
  <h2>üí≥ Process Payment</h2>
  <form id="paymentForm">
    <label>üÜî Order ID: <input type="number" id="paymentOrderId" required placeholder="Enter order ID"></label>
    <label>üí∞ Payment Method:
      <select id="paymentMethod" required>
        <option value="CASH">üíµ CASH</option>
        <option value="VNPAY">üì± VNPAY</option>
      </select>
    </label>
    <button type="button" onclick="processPayment()">‚ú® Process Payment</button>
  </form>
  <div id="paymentResult"></div>
</div>

<!-- Cancel/Refund -->
<div class="section" id="cancelSection">
  <h2>‚ùå Cancel or Refund Order</h2>
  <form id="cancelForm">
    <label>üÜî Order ID: <input type="number" id="cancelOrderId" required placeholder="Enter order ID to cancel"></label>
    <button type="button" onclick="cancelOrRefund()">üîÑ Cancel/Refund</button>
  </form>
</div>


<!-- Transactions -->

<!-- Transactions -->
<div class="section" id="transactionsSection">
  <h2>üìä Transactions by Date</h2>
  <div class="form-container">
    <div class="form-header">
      <h1>üìÖ Filter Transactions</h1>
      <p>Ch·ªçn kho·∫£ng ng√†y ƒë·ªÉ tra c·ª©u giao d·ªãch</p>
    </div>
    <form id="transactionsForm">
      <div class="form-group">
        <label for="transactionsStartDateInput">üìÖ Ng√†y B·∫Øt ƒê·∫ßu</label>
        <div class="input-wrapper">
          <input type="date" id="transactionsStartDateInput" name="startDate" class="form-input" required>
          <span class="icon">üìÖ</span>
        </div>
        <div class="error-message" id="transactionsStartDateError"></div>
      </div>

      <div class="form-group">
        <label for="transactionsEndDateInput">üìÖ Ng√†y K·∫øt Th√∫c</label>
        <div class="input-wrapper">
          <input type="date" id="transactionsEndDateInput" name="endDate" class="form-input" required>
          <span class="icon">üìÖ</span>
        </div>
        <div class="error-message" id="transactionsEndDateError"></div>
      </div>

      <div class="quick-select">
        <h3>üöÄ Ch·ªçn Nhanh Ng√†y</h3>
        <div class="quick-buttons">
          <button type="button" class="quick-btn" data-range="today">H√¥m nay</button>
          <button type="button" class="quick-btn" data-range="yesterday">H√¥m qua</button>
          <button type="button" class="quick-btn" data-range="lastWeek">Tu·∫ßn tr∆∞·ªõc</button>
          <button type="button" class="quick-btn" data-range="lastMonth">Th√°ng tr∆∞·ªõc</button>
        </div>
      </div>

      <button type="submit" class="submit-btn">‚ú® Xem Giao D·ªãch</button>
    </form>
  </div>
  <div id="transactionsResult">
    <table id="transactionsTable" style="display: none;">
      <thead>
      <tr>
        <th>Order ID</th>
        <th>Amount</th>
        <th>Payment Method</th>
        <th>Status</th>
        <th>Transaction ID</th>
        <th>Created At</th>
        <th>Updated At</th>
      </tr>
      </thead>
      <tbody id="transactionsBody"></tbody>
    </table>
  </div>
</div>

<!-- Revenue -->

<!-- Revenue -->
<div class="section" id="revenueSection">
  <h2>üí∞ Total Revenue by Date</h2>
  <div class="form-container">
    <div class="form-header">
      <h1>üìÖ Select Date Range</h1>
      <p>Ch·ªçn kho·∫£ng ng√†y ƒë·ªÉ xem doanh thu</p>
    </div>
    <form id="revenueForm">
      <div class="form-group">
        <label for="revenueStartDateInput">üìÖ Ng√†y B·∫Øt ƒê·∫ßu</label>
        <div class="input-wrapper">
          <input type="date" id="revenueStartDateInput" name="startDate" class="form-input" required>
          <span class="icon">üìÖ</span>
        </div>
        <div class="error-message" id="revenueStartDateError"></div>
      </div>

      <div class="form-group">
        <label for="revenueEndDateInput">üìÖ Ng√†y K·∫øt Th√∫c</label>
        <div class="input-wrapper">
          <input type="date" id="revenueEndDateInput" name="endDate" class="form-input" required>
          <span class="icon">üìÖ</span>
        </div>
        <div class="error-message" id="revenueEndDateError"></div>
      </div>

      <div class="quick-select">
        <h3>üöÄ Ch·ªçn Nhanh Ng√†y</h3>
        <div class="quick-buttons">
          <button type="button" class="quick-btn" data-range="today">H√¥m nay</button>
          <button type="button" class="quick-btn" data-range="yesterday">H√¥m qua</button>
          <button type="button" class="quick-btn" data-range="lastWeek">Tu·∫ßn tr∆∞·ªõc</button>
          <button type="button" class="quick-btn" data-range="lastMonth">Th√°ng tr∆∞·ªõc</button>
        </div>
      </div>

      <button type="submit" class="submit-btn">‚ú® Xem Doanh Thu</button>
    </form>
  </div>
  <div id="revenueResult"></div>
</div>



<script>
  const API_BASE_URL = "http://localhost:8080/foodhub/api/cashier";

  // Add floating particles
  function createParticles() {
      for (let i = 0; i < 20; i++) {
          const particle = document.createElement('div');
          particle.className = 'particle';
          particle.style.left = Math.random() * 100 + '%';
          particle.style.animationDelay = Math.random() * 6 + 's';
          particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
          document.body.appendChild(particle);
      }
  }

  // Initialize particles
  createParticles();

  function clearMessages() {
      document.getElementById("message").innerText = "";
      document.getElementById("error").innerText = "";
  }

  function showSection(sectionId) {
      const sections = document.querySelectorAll('.section');
      sections.forEach(section => {
          section.classList.remove('active');
      });

      const buttons = document.querySelectorAll('.nav-buttons button');
      buttons.forEach(button => {
          button.classList.remove('active');
      });

      document.getElementById(`${sectionId}Section`).classList.add('active');
      document.getElementById(`${sectionId}Btn`).classList.add('active');

      clearMessages();
  }

  async function processPayment() {
      clearMessages();
      const orderId = document.getElementById("paymentOrderId").value;
      const paymentMethod = document.getElementById("paymentMethod").value;
      const button = event.target;

      const originalText = button.innerHTML;
      button.innerHTML = originalText + '<span class="loading"></span>';
      button.disabled = true;

      try {
          const response = await fetch(`${API_BASE_URL}/payment`, {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ orderId: parseInt(orderId), paymentMethod })
          });
          const text = await response.text();
          console.log("Response from server:", text);
          const data = JSON.parse(text);
          if (response.ok) {
              document.getElementById("message").innerText = "üéâ Payment successful!";
              document.getElementById("paymentResult").innerHTML = `
                  <h3>‚úÖ Payment Result:</h3>
                  <p><strong>Order ID:</strong> ${data.orderId}</p>
                  <p><strong>Amount:</strong> ${data.amount.toLocaleString()}‚Ç´</p>
                  <p><strong>Status:</strong> ${data.status}</p>
              `;
          } else {
              throw new Error(data.message || "Payment failed");
          }
      } catch (error) {
          document.getElementById("error").innerText = "‚ùå " + error.message;
      } finally {
          button.innerHTML = originalText;
          button.disabled = false;
      }
  }

  async function cancelOrRefund() {
      clearMessages();
      const orderId = document.getElementById("cancelOrderId").value;
      const button = event.target;

      const originalText = button.innerHTML;
      button.innerHTML = originalText + '<span class="loading"></span>';
      button.disabled = true;

      try {
          const response = await fetch(`${API_BASE_URL}/cancel-or-refund/${orderId}`, {
              method: "POST",
              headers: { "Content-Type": "application/json" }
          });
          const data = await response.text();
          if (response.ok) {
              document.getElementById("message").innerText = "‚úÖ " + data;
          } else {
              throw new Error(data.message || "Cancel/Refund failed");
          }
      } catch (error) {
          document.getElementById("error").innerText = "‚ùå " + error.message;
      } finally {
          button.innerHTML = originalText;
          button.disabled = false;
      }
  }

  // H√†m ti·ªán √≠ch ƒë·ªÉ hi·ªÉn th·ªã v√† ·∫©n l·ªói
  function showError(elementId, message) {
      const errorElement = document.getElementById(elementId);
      errorElement.textContent = message;
      errorElement.style.display = 'block';
  }

  function hideError(elementId) {
      const errorElement = document.getElementById(elementId);
      errorElement.style.display = 'none';
  }

  // X·ª≠ l√Ω form Transactions
  document.getElementById('transactionsForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const button = e.submitter;

      const originalText = button.innerHTML;
      button.innerHTML = originalText + '<span class="loading"></span>';
      button.disabled = true;

      const startDateInput = document.getElementById('transactionsStartDateInput').value;
      const endDateInput = document.getElementById('transactionsEndDateInput').value;

      // Validation
      const startDate = new Date(startDateInput);
      const endDate = new Date(endDateInput);
      if (endDate < startDate) {
          showError('transactionsEndDateError', 'Ng√†y k·∫øt th√∫c ph·∫£i sau ng√†y b·∫Øt ƒë·∫ßu');
          button.innerHTML = originalText;
          button.disabled = false;
          return;
      } else {
          hideError('transactionsEndDateError');
      }

      const start = new Date(startDateInput);
      start.setHours(0, 0, 0, 0); // B·∫Øt ƒë·∫ßu ng√†y
      const end = new Date(endDateInput);
      end.setHours(23, 59, 59, 999); // K·∫øt th√∫c ng√†y

      const startIso = start.toISOString();
      const endIso = end.toISOString();
      console.log(`API Call: ${API_BASE_URL}/transactions?start=${encodeURIComponent(startIso)}&end=${encodeURIComponent(endIso)}`);

      try {
          const response = await fetch(`${API_BASE_URL}/transactions?start=${encodeURIComponent(startIso)}&end=${encodeURIComponent(endIso)}`);
          console.log("Response Status:", response.status);
          const responseBody = await response.text();
          console.log("Response Body:", responseBody);
          if (response.ok) {
              const transactions = JSON.parse(responseBody);
              const tbody = document.getElementById("transactionsBody");
              tbody.innerHTML = "";
              transactions.forEach(tx => {
                  console.log("Transaction data:", tx);
                  const row = document.createElement("tr");
                  row.innerHTML = `
                      <td>${tx.orderId || 'N/A'}</td>
                      <td>${tx.amount ? tx.amount.toLocaleString() : '0'}‚Ç´</td>
                      <td>${tx.paymentMethod || 'N/A'}</td>
                      <td><span style="color: ${tx.status === 'PAID' ? '#2ed573' : '#ff4757'}">${tx.status || 'N/A'}</span></td>
                      <td>${tx.transactionId || tx.transaction_id || 'N/A'}</td>
                      <td>${tx.createdAt ? new Date(tx.createdAt).toISOString().replace('T', ' ').split('.')[0] : 'N/A'}</td>
                      <td>${tx.updatedAt ? new Date(tx.updatedAt).toISOString().replace('T', ' ').split('.')[0] : 'N/A'}</td>
                  `;
                  tbody.appendChild(row);
              });
              document.getElementById("transactionsTable").style.display = "table";
              document.getElementById("message").innerText = `üìä Found ${transactions.length} transactions from ${startDateInput} to ${endDateInput}`;
          } else {
              throw new Error(`Failed to fetch transactions: ${responseBody}`);
          }
      } catch (error) {
          console.error("Error:", error);
          document.getElementById("error").innerText = "‚ùå " + error.message;
      } finally {
          button.innerHTML = originalText;
          button.disabled = false;
      }
  });

  // X·ª≠ l√Ω form Revenue
  document.getElementById('revenueForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const button = e.submitter;

      const originalText = button.innerHTML;
      button.innerHTML = originalText + '<span class="loading"></span>';
      button.disabled = true;

      const startDateInput = document.getElementById('revenueStartDateInput').value;
      const endDateInput = document.getElementById('revenueEndDateInput').value;

      // Validation
      const startDate = new Date(startDateInput);
      const endDate = new Date(endDateInput);
      if (endDate < startDate) {
          showError('revenueEndDateError', 'Ng√†y k·∫øt th√∫c ph·∫£i sau ng√†y b·∫Øt ƒë·∫ßu');
          button.innerHTML = originalText;
          button.disabled = false;
          return;
      } else {
          hideError('revenueEndDateError');
      }

      const start = new Date(startDateInput);
      start.setHours(0, 0, 0, 0); // B·∫Øt ƒë·∫ßu ng√†y
      const end = new Date(endDateInput);
      end.setHours(23, 59, 59, 999); // K·∫øt th√∫c ng√†y

      const startIso = start.toISOString();
      const endIso = end.toISOString();
      console.log(`API Call: ${API_BASE_URL}/revenue-stats?start=${encodeURIComponent(startIso)}&end=${encodeURIComponent(endIso)}`);

      try {
          const response = await fetch(`${API_BASE_URL}/revenue-stats?start=${encodeURIComponent(startIso)}&end=${encodeURIComponent(endIso)}`);
          console.log("Response Status:", response.status);
          const stats = await response.json();
          if (response.ok) {
              document.getElementById("revenueResult").innerHTML = `
                  <div class="revenue-stats">
                      <div class="stat-card">
                          <h4>Total Revenue</h4>
                          <div class="value">${Number(stats.totalRevenue).toLocaleString()}‚Ç´</div>
                      </div>
                      <div class="stat-card">
                          <h4>CASH Revenue</h4>
                          <div class="value">${Number(stats.cashRevenue).toLocaleString()}‚Ç´</div>
                      </div>
                      <div class="stat-card">
                          <h4>VNPAY Revenue</h4>
                          <div class="value">${Number(stats.vnpayRevenue).toLocaleString()}‚Ç´</div>
                      </div>
                      <div class="stat-card">
                          <h4>Pending</h4>
                          <div class="value">${Number(stats.pendingRevenue).toLocaleString()}‚Ç´</div>
                      </div>
                      <div class="stat-card">
                          <h4>Paid</h4>
                          <div class="value">${Number(stats.paidRevenue).toLocaleString()}‚Ç´</div>
                      </div>
                      <div class="stat-card">
                          <h4>Cancelled</h4>
                          <div class="value">${Number(stats.cancelledRevenue).toLocaleString()}‚Ç´</div>
                      </div>
                  </div>
                  <p>üìÖ From: ${startDateInput} To: ${endDateInput}</p>
              `;
              document.getElementById("message").innerText = "üí∞ Revenue stats loaded successfully!";
          } else {
              throw new Error(`Failed to fetch revenue stats: ${await response.text()}`);
          }
      } catch (error) {
          console.error("Error:", error);
          document.getElementById("error").innerText = "‚ùå " + error.message;
      } finally {
          button.innerHTML = originalText;
          button.disabled = false;
      }
  });

  // Th√™m l·∫°i x·ª≠ l√Ω cho c√°c n√∫t "Ch·ªçn Nhanh Ng√†y"
  document.addEventListener('DOMContentLoaded', function() {
      // Hi·ªÉn th·ªã section m·∫∑c ƒë·ªãnh
      showSection('payment');

      // Kh·ªüi t·∫°o m·∫∑c ƒë·ªãnh cho form Transactions
      const today = new Date();
      const transactionsStartDateInput = document.getElementById('transactionsStartDateInput');
      const transactionsEndDateInput = document.getElementById('transactionsEndDateInput');
      transactionsStartDateInput.min = '2020-01-01';
      transactionsEndDateInput.min = '2020-01-01';
      transactionsStartDateInput.value = today.toISOString().split('T')[0];
      transactionsEndDateInput.value = today.toISOString().split('T')[0];

      // Kh·ªüi t·∫°o m·∫∑c ƒë·ªãnh cho form Revenue
      const revenueStartDateInput = document.getElementById('revenueStartDateInput');
      const revenueEndDateInput = document.getElementById('revenueEndDateInput');
      revenueStartDateInput.min = '2020-01-01';
      revenueEndDateInput.min = '2020-01-01';
      revenueStartDateInput.value = today.toISOString().split('T')[0];
      revenueEndDateInput.value = today.toISOString().split('T')[0];

      // Quick range selection for Transactions and Revenue
      document.querySelectorAll('.quick-btn[data-range]').forEach(btn => {
          btn.addEventListener('click', function() {
              console.log(`Button clicked: ${this.textContent}`);
              const range = this.dataset.range;
              const today = new Date();
              const form = this.closest('form');
              const startDateInput = form.querySelector('[name="startDate"]');
              const endDateInput = form.querySelector('[name="endDate"]');

              if (!startDateInput || !endDateInput) {
                  console.error('Kh√¥ng t√¨m th·∫•y startDateInput ho·∫∑c endDateInput');
                  return;
              }

              if (range === 'today') {
                  startDateInput.value = today.toISOString().split('T')[0];
                  endDateInput.value = today.toISOString().split('T')[0];
              } else if (range === 'yesterday') {
                  const yesterday = new Date(today);
                  yesterday.setDate(today.getDate() - 1);
                  startDateInput.value = yesterday.toISOString().split('T')[0];
                  endDateInput.value = today.toISOString().split('T')[0]; // Ng√†y k·∫øt th√∫c l√† h√¥m nay
              } else if (range === 'lastWeek') {
                  const lastWeekStart = new Date(today);
                  lastWeekStart.setDate(today.getDate() - 7);
                  startDateInput.value = lastWeekStart.toISOString().split('T')[0];
                  endDateInput.value = today.toISOString().split('T')[0];
              } else if (range === 'lastMonth') {
                  const lastMonthStart = new Date(today);
                  lastMonthStart.setDate(today.getDate() - 30);
                  startDateInput.value = lastMonthStart.toISOString().split('T')[0];
                  endDateInput.value = today.toISOString().split('T')[0];
              }

              // C·∫≠p nh·∫≠t tr·∫°ng th√°i active cho n√∫t
              form.querySelectorAll('.quick-btn[data-range]').forEach(b => b.classList.remove('active'));
              this.classList.add('active');
          });
      });
  });
</script>


</body>
</html>